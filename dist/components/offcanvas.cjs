"use strict";var q=Object.defineProperty;var k=(o,t,s)=>t in o?q(o,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[t]=s;var d=(o,t,s)=>(k(o,typeof t!="symbol"?t+"":t,s),s);const e=require("@thednp/shorty"),h=require("@thednp/event-listener"),A=require("./dataBsDismiss-4ee313a7.js"),$=require("./dataBsToggle-c8bc9e7f.js"),f=require("./showClass-2174a6d6.js"),c=require("./popupContainer-edee469f.js"),a=require("./isVisible-12a76845.js"),S=require("./getTargetElement-93cf2bb8.js"),H=require("./base-component-f3cef043.js");require("./fadeClass-a4944cf1.js");const L=`.${c.offcanvasString}`,E=`[${$.dataBsToggle}="${c.offcanvasString}"]`,B=`[${A.dataBsDismiss}="${c.offcanvasString}"]`,p=`${c.offcanvasString}-toggling`,I={backdrop:!0,keyboard:!0,scroll:!1},u=o=>e.getInstance(o,a.offcanvasComponent),P=o=>new v(o),m=e.createCustomEvent(`show.bs.${c.offcanvasString}`),w=e.createCustomEvent(`shown.bs.${c.offcanvasString}`),y=e.createCustomEvent(`hide.bs.${c.offcanvasString}`),D=e.createCustomEvent(`hidden.bs.${c.offcanvasString}`),_=o=>{const{element:t}=o,{clientHeight:s,scrollHeight:n}=e.getDocumentElement(t);a.setScrollbar(t,s!==n)},O=(o,t)=>{const s=t?h.addListener:h.removeListener,n=e.getDocument(o.element);s(n,e.keydownEvent,V),s(n,e.mouseclickEvent,N)},T=o=>{const{element:t,options:s}=o;s.scroll||(_(o),e.setElementStyle(e.getDocumentBody(t),{overflow:"hidden"})),e.addClass(t,p),e.addClass(t,f.showClass),e.setElementStyle(t,{visibility:"visible"}),e.emulateTransitionEnd(t,()=>K(o))},x=o=>{const{element:t,options:s}=o,n=a.getCurrentOpen(t);t.blur(),!n&&s.backdrop&&e.hasClass(a.overlay,f.showClass)&&a.hideOverlay(),e.emulateTransitionEnd(t,()=>j(o))},M=o=>{const t=e.closest(o.target,E),s=t&&S.getTargetElement(t),n=s&&u(s);n&&(n.relatedTarget=t,n.toggle(),t&&t.tagName==="A"&&o.preventDefault())},N=o=>{const{target:t}=o,s=e.querySelector(a.offcanvasActiveSelector,e.getDocument(t)),n=e.querySelector(B,s),r=s&&u(s);if(r){const{options:l,triggers:i}=r,{backdrop:g}=l,C=e.closest(t,E),b=e.getDocument(s).getSelection();(!a.overlay.contains(t)||g!=="static")&&(!(b&&b.toString().length)&&(!s.contains(t)&&g&&(!C||i.includes(t))||n&&n.contains(t))&&(r.relatedTarget=n&&n.contains(t)?n:null,r.hide()),C&&C.tagName==="A"&&o.preventDefault())}},V=({code:o,target:t})=>{const s=e.querySelector(a.offcanvasActiveSelector,e.getDocument(t)),n=s&&u(s);n&&n.options.keyboard&&o===e.keyEscape&&(n.relatedTarget=null,n.hide())},K=o=>{const{element:t}=o;e.removeClass(t,p),e.removeAttribute(t,e.ariaHidden),e.setAttribute(t,e.ariaModal,"true"),e.setAttribute(t,"role","dialog"),e.dispatchEvent(t,w),O(o,!0),e.focus(t)},j=o=>{const{element:t,triggers:s}=o;e.setAttribute(t,e.ariaHidden,"true"),e.removeAttribute(t,e.ariaModal),e.removeAttribute(t,"role"),e.setElementStyle(t,{visibility:""});const n=m.relatedTarget||s.find(a.isVisible);n&&e.focus(n),a.removeOverlay(t),e.dispatchEvent(t,D),e.removeClass(t,p),a.getCurrentOpen(t)||O(o)};class v extends H.BaseComponent{constructor(s,n){super(s,n);d(this,"_toggleEventListeners",s=>{const n=s?h.addListener:h.removeListener;this.triggers.forEach(r=>n(r,e.mouseclickEvent,M))});const{element:r}=this;this.triggers=[...e.querySelectorAll(E,e.getDocument(r))].filter(l=>S.getTargetElement(l)===r),this.relatedTarget=null,this._toggleEventListeners(!0)}get name(){return a.offcanvasComponent}get defaults(){return I}toggle(){e.hasClass(this.element,f.showClass)?this.hide():this.show()}show(){const{element:s,options:n,relatedTarget:r}=this;let l=0;if(!e.hasClass(s,f.showClass)&&(m.relatedTarget=r||void 0,w.relatedTarget=r||void 0,e.dispatchEvent(s,m),!m.defaultPrevented)){const i=a.getCurrentOpen(s);if(i&&i!==s){const g=u(i)||e.getInstance(i,a.modalComponent);g&&g.hide()}n.backdrop?(c.hasPopup(a.overlay)?a.toggleOverlayType():a.appendOverlay(s,!0),l=e.getElementTransitionDuration(a.overlay),a.showOverlay(),setTimeout(()=>T(this),l)):(T(this),i&&e.hasClass(a.overlay,f.showClass)&&a.hideOverlay())}}hide(){const{element:s,relatedTarget:n}=this;e.hasClass(s,f.showClass)&&(y.relatedTarget=n||void 0,D.relatedTarget=n||void 0,e.dispatchEvent(s,y),y.defaultPrevented||(e.addClass(s,p),e.removeClass(s,f.showClass),x(this)))}dispose(){const s={...this},{element:n,options:r}=s,l=r.backdrop?e.getElementTransitionDuration(a.overlay):0,i=()=>setTimeout(()=>super.dispose(),l+17);this._toggleEventListeners(),this.hide(),e.hasClass(n,f.showClass)?e.emulateTransitionEnd(n,i):i()}}d(v,"selector",L),d(v,"init",P),d(v,"getInstance",u);module.exports=v;
//# sourceMappingURL=offcanvas.cjs.map
