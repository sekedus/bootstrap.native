"use strict";const t=require("./base-component-D3rSrWwH.js"),d=require("./event-listener-W3RGkfJ6.js"),D=require("./dataBsDismiss-CMHF7If_.js"),k=require("./dataBsToggle-Dj-Ng54N.js"),c=require("./showClass-D_Ms1FgG.js"),r=require("./popupContainer-D8In9VFi.js"),a=require("./isVisible-qgH-7RtV.js"),y=require("./getTargetElement-DOtJ4BXO.js"),q=`.${r.offcanvasString}`,p=`[${k.dataBsToggle}="${r.offcanvasString}"]`,A=`[${D.dataBsDismiss}="${r.offcanvasString}"]`,u=`${r.offcanvasString}-toggling`,$={backdrop:!0,keyboard:!0,scroll:!1},f=o=>t.getInstance(o,a.offcanvasComponent),H=o=>new w(o),v=t.createCustomEvent(`show.bs.${r.offcanvasString}`),T=t.createCustomEvent(`shown.bs.${r.offcanvasString}`),h=t.createCustomEvent(`hide.bs.${r.offcanvasString}`),S=t.createCustomEvent(`hidden.bs.${r.offcanvasString}`),B=o=>{const{element:e}=o,{clientHeight:n,scrollHeight:s}=t.getDocumentElement(e);a.setScrollbar(e,n!==s)},O=(o,e)=>{const n=e?d.E:d.r,s=t.getDocument(o.element);n(s,t.keydownEvent,_),n(s,t.mouseclickEvent,P)},b=o=>{const{element:e,options:n}=o;n.scroll||(B(o),t.setElementStyle(t.getDocumentBody(e),{overflow:"hidden"})),t.addClass(e,u),t.addClass(e,c.showClass),t.setElementStyle(e,{visibility:"visible"}),t.emulateTransitionEnd(e,()=>x(o))},I=o=>{const{element:e,options:n}=o,s=a.getCurrentOpen(e);e.blur(),!s&&n.backdrop&&t.hasClass(a.overlay,c.showClass)&&a.hideOverlay(),t.emulateTransitionEnd(e,()=>F(o))},L=o=>{const e=t.closest(o.target,p),n=e&&y.getTargetElement(e),s=n&&f(n);s&&(s.relatedTarget=e,s.toggle(),e&&e.tagName==="A"&&o.preventDefault())},P=o=>{const{target:e}=o,n=t.querySelector(a.offcanvasActiveSelector,t.getDocument(e)),s=t.querySelector(A,n),i=n&&f(n);if(i){const{options:l,triggers:g}=i,{backdrop:C}=l,m=t.closest(e,p),E=t.getDocument(n).getSelection();(!a.overlay.contains(e)||C!=="static")&&(!(E&&E.toString().length)&&(!n.contains(e)&&C&&(!m||g.includes(e))||s&&s.contains(e))&&(i.relatedTarget=s&&s.contains(e)?s:null,i.hide()),m&&m.tagName==="A"&&o.preventDefault())}},_=({code:o,target:e})=>{const n=t.querySelector(a.offcanvasActiveSelector,t.getDocument(e)),s=n&&f(n);s&&s.options.keyboard&&o===t.keyEscape&&(s.relatedTarget=null,s.hide())},x=o=>{const{element:e}=o;t.removeClass(e,u),t.removeAttribute(e,t.ariaHidden),t.setAttribute(e,t.ariaModal,"true"),t.setAttribute(e,"role","dialog"),t.dispatchEvent(e,T),O(o,!0),t.focus(e),t.toggleFocusTrap(e)},F=o=>{const{element:e,triggers:n}=o;t.setAttribute(e,t.ariaHidden,"true"),t.removeAttribute(e,t.ariaModal),t.removeAttribute(e,"role"),t.setElementStyle(e,{visibility:""});const s=v.relatedTarget||n.find(a.isVisible);s&&t.focus(s),a.removeOverlay(e),t.dispatchEvent(e,S),t.removeClass(e,u),t.toggleFocusTrap(e),a.getCurrentOpen(e)||O(o)};class w extends t.BaseComponent{static selector=q;static init=H;static getInstance=f;constructor(e,n){super(e,n);const{element:s}=this;this.triggers=[...t.querySelectorAll(p,t.getDocument(s))].filter(i=>y.getTargetElement(i)===s),this.relatedTarget=null,this._toggleEventListeners(!0)}get name(){return a.offcanvasComponent}get defaults(){return $}toggle(){t.hasClass(this.element,c.showClass)?this.hide():this.show()}show(){const{element:e,options:n,relatedTarget:s}=this;let i=0;if(!t.hasClass(e,c.showClass)&&(v.relatedTarget=s||void 0,T.relatedTarget=s||void 0,t.dispatchEvent(e,v),!v.defaultPrevented)){const l=a.getCurrentOpen(e);if(l&&l!==e){const g=f(l)||t.getInstance(l,a.modalComponent);g&&g.hide()}n.backdrop?(r.hasPopup(a.overlay)?a.toggleOverlayType():a.appendOverlay(e,!0),i=t.getElementTransitionDuration(a.overlay),a.showOverlay(),setTimeout(()=>b(this),i)):(b(this),l&&t.hasClass(a.overlay,c.showClass)&&a.hideOverlay())}}hide(){const{element:e,relatedTarget:n}=this;t.hasClass(e,c.showClass)&&(h.relatedTarget=n||void 0,S.relatedTarget=n||void 0,t.dispatchEvent(e,h),h.defaultPrevented||(t.addClass(e,u),t.removeClass(e,c.showClass),I(this)))}_toggleEventListeners=e=>{const n=e?d.E:d.r;this.triggers.forEach(s=>n(s,t.mouseclickEvent,L))};dispose(){const{element:e}=this,n=t.hasClass(e,c.showClass),s=()=>setTimeout(()=>super.dispose(),1);this.hide(),this._toggleEventListeners(),n?t.emulateTransitionEnd(e,s):s()}}module.exports=w;
//# sourceMappingURL=offcanvas.cjs.map
