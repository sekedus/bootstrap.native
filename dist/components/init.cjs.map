{"version":3,"file":"init.cjs","sources":["../../src/util/init.ts"],"sourcesContent":["import { Data, ObjectKeys, ObjectValues, getElementsByTagName, matches } from '@thednp/shorty';\n\nimport { addListener } from '@thednp/event-listener';\n\nimport Alert from '../components/alert';\nimport Button from '../components/button';\nimport Carousel from '../components/carousel';\nimport Collapse from '../components/collapse';\nimport Dropdown from '../components/dropdown';\nimport Modal from '../components/modal';\nimport Offcanvas from '../components/offcanvas';\nimport Popover from '../components/popover';\nimport ScrollSpy from '../components/scrollspy';\nimport Tab from '../components/tab';\nimport Toast from '../components/toast';\nimport Tooltip from '../components/tooltip';\n\nconst componentsList = {\n  Alert,\n  Button,\n  Carousel,\n  Collapse,\n  Dropdown,\n  Modal,\n  Offcanvas,\n  Popover,\n  ScrollSpy,\n  Tab,\n  Toast,\n  Tooltip,\n};\n\n/**\n * Initialize all matched `Element`s for one component.\n *\n * @param callback\n * @param collection\n */\nconst initComponentDataAPI = <T>(\n  callback: (el: HTMLElement, ops?: Record<string, unknown>) => T,\n  collection: HTMLCollectionOf<HTMLElement> | HTMLElement[],\n) => {\n  [...collection].forEach(x => callback(x));\n};\n\n/**\n * Remove one component from a target container element or all in the page.\n *\n * @param component the component name\n * @param context parent `Node`\n */\nconst removeComponentDataAPI = <T>(component: string, context: ParentNode) => {\n  const compData = Data.getAllFor(component) as Map<HTMLElement, T>;\n\n  if (compData) {\n    [...compData].forEach(([element, instance]) => {\n      if (context.contains(element)) (instance as T & { dispose: () => void }).dispose();\n    });\n  }\n};\n\n/**\n * Initialize all BSN components for a target container.\n *\n * @param context parent `Node`\n */\nexport const initCallback = (context?: ParentNode) => {\n  const lookUp = context && context.nodeName ? context : document;\n  const elemCollection = [...getElementsByTagName('*', lookUp)];\n\n  ObjectValues(componentsList).forEach(cs => {\n    const { init, selector } = cs;\n    initComponentDataAPI(\n      init,\n      elemCollection.filter(item => matches(item, selector)),\n    );\n  });\n};\n\n/**\n * Remove all BSN components for a target container.\n *\n * @param context parent `Node`\n */\nexport const removeDataAPI = (context?: ParentNode) => {\n  const lookUp = context && context.nodeName ? context : document;\n\n  ObjectKeys(componentsList).forEach(comp => {\n    removeComponentDataAPI(comp, lookUp);\n  });\n};\n\n// bulk initialize all components\nif (document.body) initCallback();\nelse {\n  addListener(document, 'DOMContentLoaded', () => initCallback(), { once: true });\n}\n"],"names":["componentsList","Alert","Button","Carousel","Collapse","Dropdown","Modal","Offcanvas","Popover","ScrollSpy","Tab","Toast","Tooltip","initComponentDataAPI","callback","collection","x","removeComponentDataAPI","component","context","compData","Data","element","instance","initCallback","lookUp","elemCollection","getElementsByTagName","ObjectValues","cs","init","selector","item","matches","removeDataAPI","ObjectKeys","comp","addListener"],"mappings":"uzCAiBA,MAAMA,EAAiB,CAAA,MACrBC,EAAA,OACAC,EAAA,SACAC,EAAA,SACAC,EAAA,SACAC,EAAA,MACAC,EAAA,UACAC,EAAA,QACAC,EAAA,UACAC,EAAA,IACAC,EAAA,MACAC,EAAA,QACAC,CACF,EAQMC,EAAuB,CAC3BC,EACAC,IACG,CACH,CAAC,GAAGA,CAAU,EAAE,QAAaC,GAAAF,EAASE,CAAC,CAAC,CAC1C,EAQMC,EAAyB,CAAIC,EAAmBC,IAAwB,CACtE,MAAAC,EAAWC,EAAAA,EAAK,UAAUH,CAAS,EAErCE,GACD,CAAA,GAAGA,CAAQ,EAAE,QAAQ,CAAC,CAACE,EAASC,CAAQ,IAAM,CACzCJ,EAAQ,SAASG,CAAO,GAAIC,EAAyC,QAAQ,CAAA,CAClF,CAEL,EAOaC,EAAgBL,GAAyB,CACpD,MAAMM,EAASN,GAAWA,EAAQ,SAAWA,EAAU,SACjDO,EAAiB,CAAC,GAAGC,EAAAA,GAAqB,IAAKF,CAAM,CAAC,EAE/CG,EAAAA,GAAA5B,CAAc,EAAE,QAAc6B,GAAA,CACnC,KAAA,CAAE,KAAAC,EAAM,SAAAC,CAAa,EAAAF,EAC3BhB,EACEiB,EACAJ,EAAe,OAAOM,GAAQC,EAAAA,GAAQD,EAAMD,CAAQ,CAAC,CAAA,CACvD,CACD,CACH,EAOaG,EAAiBf,GAAyB,CACrD,MAAMM,EAASN,GAAWA,EAAQ,SAAWA,EAAU,SAE5CgB,EAAAA,GAAAnC,CAAc,EAAE,QAAgBoC,GAAA,CACzCnB,EAAuBmB,EAAMX,CAAM,CAAA,CACpC,CACH,EAGI,SAAS,KAAmBD,IAElBa,IAAA,SAAU,mBAAoB,IAAMb,IAAgB,CAAE,KAAM,GAAM"}