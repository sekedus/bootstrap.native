"use strict";var S=Object.defineProperty;var L=(t,s,o)=>s in t?S(t,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[s]=o;var g=(t,s,o)=>L(t,typeof s!="symbol"?s+"":s,o);const e=require("@thednp/shorty"),D=require("./index-C8qIpGHG.js"),f=require("./activeClass-CxJYQAGN.js"),_=require("./base-component-DBcDoOjV.js"),q="scrollspy",T="ScrollSpy",A='[data-bs-spy="scroll"]',B={offset:10,target:null},w=t=>e.getInstance(t,T),x=t=>new v(t),y=e.createCustomEvent(`activate.bs.${q}`),M=t=>{const{target:s,scrollTarget:o,options:r,itemsLength:i,scrollHeight:n,element:a}=t,{offset:c}=r,h=o!==a,l=s&&e.getElementsByTagName("A",s),m=e.getDocument(a),d=o?b(o):n;t.scrollTop=o.scrollTop;// istanbul ignore else @preserve
if(l&&(d!==n||i!==l.length)){let p,u,C;t.items=[],t.targets=[],t.offsets=[],t.scrollHeight=d,t.maxScroll=t.scrollHeight-k(t),Array.from(l).forEach(E=>{p=e.getAttribute(E,"href"),u=p&&p.charAt(0)==="#"&&p.slice(-1)!=="#"&&e.querySelector(p,m),u&&(t.items.push(E),t.targets.push(u),C=e.getBoundingClientRect(u),t.offsets.push((h?C.top+t.scrollTop:u.offsetTop)-c))}),t.itemsLength=t.items.length}},b=t=>e.isHTMLElement(t)?t.scrollHeight:e.getDocumentElement(t).scrollHeight,k=({element:t,scrollTarget:s})=>s!==t?s.clientHeight:e.getBoundingClientRect(t).height,I=t=>{[...e.getElementsByTagName("A",t)].forEach(s=>{e.hasClass(s,f.activeClass)&&e.removeClass(s,f.activeClass)})},H=(t,s)=>{const{target:o,element:r}=t;// istanbul ignore else @preserve
e.isHTMLElement(o)&&I(o),t.activeItem=s,e.addClass(s,f.activeClass);const i=[];let n=s;for(;n!==e.getDocumentBody(r);)n=n.parentElement,(e.hasClass(n,"nav")||e.hasClass(n,"dropdown-menu"))&&i.push(n);i.forEach(a=>{const c=a.previousElementSibling;// istanbul ignore else @preserve
c&&!e.hasClass(c,f.activeClass)&&e.addClass(c,f.activeClass)}),y.relatedTarget=s,e.dispatchEvent(r,y)};class v extends _.BaseComponent{constructor(o,r){super(o,r);g(this,"refresh",()=>{const{target:o}=this;// istanbul ignore else @preserve
if(e.isHTMLElement(o)&&o.offsetHeight>0){M(this);const{scrollTop:r,maxScroll:i,itemsLength:n,items:a,activeItem:c}=this;if(r>=i){const l=a[n-1];// istanbul ignore else @preserve
c!==l&&H(this,l);return}const{offsets:h}=this;// istanbul ignore else @preserve
if(c&&r<h[0]&&h[0]>0){this.activeItem=null;// istanbul ignore else @preserve
o&&I(o);return}a.forEach((l,m)=>{c!==l&&r>=h[m]&&(typeof h[m+1]>"u"||r<h[m+1])&&H(this,l)})}});g(this,"_toggleEventListeners",o=>{o?this.scrollTarget===this.element?this.targets.forEach(r=>this._observer.observe(r)):this._observer.observe(this.element):this._observer.disconnect()});const{element:i,options:n}=this;this.target=e.querySelector(n.target,e.getDocument(i)),this.target&&(this.scrollTarget=i.clientHeight<i.scrollHeight?i:e.getDocumentElement(i),this.scrollHeight=b(this.scrollTarget),this.refresh(),this._observer=new D.D(()=>this.refresh(),{root:this.scrollTarget}),this._toggleEventListeners(!0))}get name(){return T}get defaults(){return B}dispose(){this._toggleEventListeners(),super.dispose()}}g(v,"selector",A),g(v,"init",x),g(v,"getInstance",w);module.exports=v;
//# sourceMappingURL=scrollspy.cjs.map
