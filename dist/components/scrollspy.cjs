"use strict";const s=require("./base-component-D3rSrWwH.js"),I=require("./index-BRPRSfaI.js"),u=require("./activeClass-CxJYQAGN.js"),b="scrollspy",S="ScrollSpy",x='[data-bs-spy="scroll"]',A={offset:10,target:null},B=t=>s.getInstance(t,S),L=t=>new E(t),v=s.createCustomEvent(`activate.bs.${b}`),q=t=>{const{target:e,scrollTarget:o,options:c,itemsLength:l,scrollHeight:r,element:i}=t,{offset:n}=c,a=o!==i,h=e&&s.getElementsByTagName("A",e),T=s.getDocument(i),m=o.scrollHeight;if(t.scrollTop=o.scrollTop,h&&(m!==r||l!==h.length)){let g,p,f;t.items=[],t.targets=[],t.offsets=[],t.scrollHeight=m,t.maxScroll=t.scrollHeight-D(t),Array.from(h).forEach(d=>{g=s.getAttribute(d,"href"),p=g&&g.charAt(0)==="#"&&g.slice(-1)!=="#"&&s.querySelector(g,T),p&&(t.items.push(d),t.targets.push(p),f=s.getBoundingClientRect(p),t.offsets.push((a?f.top+t.scrollTop:p.offsetTop)-n))}),t.itemsLength=t.items.length}},C=({targets:t,scrollTarget:e,element:o,_observer:c},l)=>{l?e===o?t.forEach(r=>c.observe(r)):c.observe(o):c.disconnect()},w=t=>t.scrollHeight,D=({element:t,scrollTarget:e})=>e!==t?e.clientHeight:s.getBoundingClientRect(t).height,H=t=>{[...s.getElementsByTagName("A",t)].forEach(e=>{s.hasClass(e,u.activeClass)&&s.removeClass(e,u.activeClass)})},y=(t,e)=>{const{target:o,element:c}=t;s.isHTMLElement(o)&&H(o),t.activeItem=e,s.addClass(e,u.activeClass);const l=[];let r=e;for(;r!==s.getDocumentBody(c);)r=r.parentElement,(s.hasClass(r,"nav")||s.hasClass(r,"dropdown-menu"))&&l.push(r);l.forEach(i=>{const n=i.previousElementSibling;n&&!s.hasClass(n,u.activeClass)&&s.addClass(n,u.activeClass)}),v.relatedTarget=e,s.dispatchEvent(c,v)};class E extends s.BaseComponent{static selector=x;static init=L;static getInstance=B;constructor(e,o){super(e,o);const{element:c,options:l}=this;this.target=s.querySelector(l.target,s.getDocument(c)),this.target&&(this.scrollTarget=c.clientHeight<c.scrollHeight?c:s.getDocumentElement(c),this.scrollHeight=w(this.scrollTarget),this.refresh(),this._observer=new I.x(()=>this.refresh(),{root:this.scrollTarget}),C(this,!0))}get name(){return S}get defaults(){return A}refresh=()=>{const{target:e}=this;if(s.isHTMLElement(e)&&e.offsetHeight>0){q(this);const{scrollTop:o,maxScroll:c,itemsLength:l,items:r,activeItem:i}=this;if(o>=c){const a=r[l-1];i!==a&&y(this,a);return}const{offsets:n}=this;if(i&&o<n[0]&&n[0]>0){this.activeItem=null,e&&H(e);return}r.forEach((a,h)=>{i!==a&&o>=n[h]&&(typeof n[h+1]>"u"||o<n[h+1])&&y(this,a)})}};dispose(){const e={...this};C(e),super.dispose()}}module.exports=E;
//# sourceMappingURL=scrollspy.cjs.map
