"use strict";var S=Object.defineProperty;var w=(t,n,s)=>n in t?S(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s;var p=(t,n,s)=>(w(t,typeof n!="symbol"?n+"":n,s),s);const e=require("@thednp/shorty"),E=require("@thednp/event-listener"),m=require("./activeClass-a1284579.js"),b=require("./base-component-f3cef043.js"),q="scrollspy",T="ScrollSpy",B='[data-bs-spy="scroll"]',A={offset:10,target:null},D=t=>e.getInstance(t,T),x=t=>new f(t),H=e.createCustomEvent(`activate.bs.${q}`),W=t=>{const{target:n,scrollTarget:s,options:i,itemsLength:r,scrollHeight:o,element:g}=t,{offset:c}=i,a=e.isWindow(s),l=n&&e.getElementsByTagName("A",n),h=s?L(s):o;if(t.scrollTop=a?s.scrollY:s.scrollTop,l&&(h!==o||r!==l.length)){let u,d,v;t.items=[],t.offsets=[],t.scrollHeight=h,t.maxScroll=t.scrollHeight-M(t),[...l].forEach(C=>{u=e.getAttribute(C,"href"),d=u&&u.charAt(0)==="#"&&u.slice(-1)!=="#"&&e.querySelector(u,e.getDocument(g)),d&&(t.items.push(C),v=e.getBoundingClientRect(d),t.offsets.push((a?v.top+t.scrollTop:d.offsetTop)-c))}),t.itemsLength=t.items.length}},L=t=>e.isHTMLElement(t)?t.scrollHeight:e.getDocumentElement(t).scrollHeight,M=({element:t,scrollTarget:n})=>e.isWindow(n)?n.innerHeight:e.getBoundingClientRect(t).height,I=t=>{[...e.getElementsByTagName("A",t)].forEach(n=>{e.hasClass(n,m.activeClass)&&e.removeClass(n,m.activeClass)})},y=(t,n)=>{const{target:s,element:i}=t;e.isHTMLElement(s)&&I(s),t.activeItem=n,e.addClass(n,m.activeClass);const r=[];let o=n;for(;o!==e.getDocumentBody(i);)o=o.parentElement,(e.hasClass(o,"nav")||e.hasClass(o,"dropdown-menu"))&&r.push(o);r.forEach(g=>{const c=g.previousElementSibling;c&&!e.hasClass(c,m.activeClass)&&e.addClass(c,m.activeClass)}),H.relatedTarget=n,e.dispatchEvent(i,H)};class f extends b.BaseComponent{constructor(s,i){super(s,i);p(this,"refresh",()=>{const{target:s}=this;if(e.isHTMLElement(s)&&s.offsetHeight>0){W(this);const{scrollTop:i,maxScroll:r,itemsLength:o,items:g,activeItem:c}=this;if(i>=r){const l=g[o-1];c!==l&&y(this,l);return}const{offsets:a}=this;if(c&&i<a[0]&&a[0]>0){this.activeItem=null,s&&I(s);return}g.forEach((l,h)=>{c!==l&&i>=a[h]&&(typeof a[h+1]>"u"||i<a[h+1])&&y(this,l)})}});p(this,"_toggleEventListeners",s=>{(s?E.addListener:E.removeListener)(this.scrollTarget,e.scrollEvent,this.refresh,e.passiveHandler)});const{element:r,options:o}=this;this.target=e.querySelector(o.target,e.getDocument(r)),this.target&&(this.scrollTarget=r.clientHeight<r.scrollHeight?r:e.getWindow(r),this.scrollHeight=L(this.scrollTarget),this._toggleEventListeners(!0),this.refresh())}get name(){return T}get defaults(){return A}dispose(){this._toggleEventListeners(),super.dispose()}}p(f,"selector",B),p(f,"init",x),p(f,"getInstance",D);module.exports=f;
//# sourceMappingURL=scrollspy.cjs.map
