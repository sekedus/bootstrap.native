"use strict";var S=Object.defineProperty;var w=(t,s,n)=>s in t?S(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n;var p=(t,s,n)=>w(t,typeof s!="symbol"?s+"":s,n);const e=require("@thednp/shorty"),E=require("@thednp/event-listener"),m=require("./activeClass-CxJYQAGN.js"),b=require("./base-component-j_bwTL_x.js"),q="scrollspy",T="ScrollSpy",B='[data-bs-spy="scroll"]',A={offset:10,target:null},D=t=>e.getInstance(t,T),x=t=>new f(t),H=e.createCustomEvent(`activate.bs.${q}`),W=t=>{const{target:s,scrollTarget:n,options:i,itemsLength:r,scrollHeight:o,element:g}=t,{offset:c}=i,a=e.isWindow(n),l=s&&e.getElementsByTagName("A",s),h=n?L(n):o;if(t.scrollTop=a?n.scrollY:n.scrollTop,l&&(h!==o||r!==l.length)){let u,d,v;t.items=[],t.offsets=[],t.scrollHeight=h,t.maxScroll=t.scrollHeight-M(t),[...l].forEach(C=>{u=e.getAttribute(C,"href"),d=u&&u.charAt(0)==="#"&&u.slice(-1)!=="#"&&e.querySelector(u,e.getDocument(g)),d&&(t.items.push(C),v=e.getBoundingClientRect(d),t.offsets.push((a?v.top+t.scrollTop:d.offsetTop)-c))}),t.itemsLength=t.items.length}},L=t=>e.isHTMLElement(t)?t.scrollHeight:e.getDocumentElement(t).scrollHeight,M=({element:t,scrollTarget:s})=>e.isWindow(s)?s.innerHeight:e.getBoundingClientRect(t).height,I=t=>{[...e.getElementsByTagName("A",t)].forEach(s=>{e.hasClass(s,m.activeClass)&&e.removeClass(s,m.activeClass)})},y=(t,s)=>{const{target:n,element:i}=t;e.isHTMLElement(n)&&I(n),t.activeItem=s,e.addClass(s,m.activeClass);const r=[];let o=s;for(;o!==e.getDocumentBody(i);)o=o.parentElement,(e.hasClass(o,"nav")||e.hasClass(o,"dropdown-menu"))&&r.push(o);r.forEach(g=>{const c=g.previousElementSibling;c&&!e.hasClass(c,m.activeClass)&&e.addClass(c,m.activeClass)}),H.relatedTarget=s,e.dispatchEvent(i,H)};class f extends b.BaseComponent{constructor(n,i){super(n,i);p(this,"refresh",()=>{const{target:n}=this;if(e.isHTMLElement(n)&&n.offsetHeight>0){W(this);const{scrollTop:i,maxScroll:r,itemsLength:o,items:g,activeItem:c}=this;if(i>=r){const l=g[o-1];c!==l&&y(this,l);return}const{offsets:a}=this;if(c&&i<a[0]&&a[0]>0){this.activeItem=null,n&&I(n);return}g.forEach((l,h)=>{c!==l&&i>=a[h]&&(typeof a[h+1]>"u"||i<a[h+1])&&y(this,l)})}});p(this,"_toggleEventListeners",n=>{(n?E.addListener:E.removeListener)(this.scrollTarget,e.scrollEvent,this.refresh,e.passiveHandler)});const{element:r,options:o}=this;this.target=e.querySelector(o.target,e.getDocument(r)),this.target&&(this.scrollTarget=r.clientHeight<r.scrollHeight?r:e.getWindow(r),this.scrollHeight=L(this.scrollTarget),this._toggleEventListeners(!0),this.refresh())}get name(){return T}get defaults(){return A}dispose(){this._toggleEventListeners(),super.dispose()}}p(f,"selector",B),p(f,"init",x),p(f,"getInstance",D);module.exports=f;
//# sourceMappingURL=scrollspy.cjs.map
