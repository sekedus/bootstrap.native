"use strict";const e=require("./base-component-D3rSrWwH.js"),v=require("./event-listener-W3RGkfJ6.js"),$=require("./dataBsToggle-Dj-Ng54N.js"),F=require("./dataBsDismiss-CMHF7If_.js"),A=require("./fadeClass-Co6nOzNJ.js"),c=require("./showClass-D_Ms1FgG.js"),r=require("./popupContainer-D8In9VFi.js"),l=require("./isVisible-qgH-7RtV.js"),D=require("./getTargetElement-DOtJ4BXO.js"),B=`.${r.modalString}`,k=`[${$.dataBsToggle}="${r.modalString}"]`,I=`[${F.dataBsDismiss}="${r.modalString}"]`,M=`${r.modalString}-static`,L={backdrop:!0,keyboard:!0},h=o=>e.getInstance(o,l.modalComponent),_=o=>new O(o),p=e.createCustomEvent(`show.bs.${r.modalString}`),E=e.createCustomEvent(`shown.bs.${r.modalString}`),f=e.createCustomEvent(`hide.bs.${r.modalString}`),T=e.createCustomEvent(`hidden.bs.${r.modalString}`),H=o=>{const{element:t}=o,s=l.measureScrollbar(t),{clientHeight:a,scrollHeight:n}=e.getDocumentElement(t),{clientHeight:d,scrollHeight:g}=t,i=d!==g;if(!i&&s){const u={[e.isRTL(t)?"paddingLeft":"paddingRight"]:`${s}px`};e.setElementStyle(t,u)}l.setScrollbar(t,i||a!==n)},q=(o,t)=>{const s=t?v.E:v.r,{element:a}=o;s(a,e.mouseclickEvent,P),s(e.getDocument(a),e.keydownEvent,R),t?o._observer.observe(a):o._observer.disconnect()},b=o=>{const{triggers:t,element:s,relatedTarget:a}=o;l.removeOverlay(s),e.setElementStyle(s,{paddingRight:"",display:""}),q(o);const n=p.relatedTarget||t.find(l.isVisible);n&&e.focus(n),T.relatedTarget=a,e.dispatchEvent(s,T),e.toggleFocusTrap(s)},S=o=>{const{element:t,relatedTarget:s}=o;e.focus(t),q(o,!0),E.relatedTarget=s,e.dispatchEvent(t,E),e.toggleFocusTrap(t)},y=o=>{const{element:t,hasFade:s}=o;e.setElementStyle(t,{display:"block"}),H(o),l.getCurrentOpen(t)||e.setElementStyle(e.getDocumentBody(t),{overflow:"hidden"}),e.addClass(t,c.showClass),e.removeAttribute(t,e.ariaHidden),e.setAttribute(t,e.ariaModal,"true"),s?e.emulateTransitionEnd(t,()=>S(o)):S(o)},w=o=>{const{element:t,options:s,hasFade:a}=o;s.backdrop&&a&&e.hasClass(l.overlay,c.showClass)&&!l.getCurrentOpen(t)?(l.hideOverlay(),e.emulateTransitionEnd(l.overlay,()=>b(o))):b(o)},x=o=>{const{target:t}=o,s=t&&e.closest(t,k),a=s&&D.getTargetElement(s),n=a&&h(a);n&&(s&&s.tagName==="A"&&o.preventDefault(),n.relatedTarget=s,n.toggle())},R=({code:o,target:t})=>{const s=e.querySelector(l.modalActiveSelector,e.getDocument(t)),a=s&&h(s);if(a){const{options:n}=a;n.keyboard&&o===e.keyEscape&&e.hasClass(s,c.showClass)&&(a.relatedTarget=null,a.hide())}},P=o=>{const{currentTarget:t}=o,s=t&&h(t);if(s&&t&&!e.Timer.get(t)){const{options:a,isStatic:n,modalDialog:d}=s,{backdrop:g}=a,{target:i}=o,m=e.getDocument(t)?.getSelection()?.toString().length,u=d.contains(i),C=i&&e.closest(i,I);n&&!u?e.Timer.set(t,()=>{e.addClass(t,M),e.emulateTransitionEnd(d,()=>V(s))},17):(C||!m&&!n&&!u&&g)&&(s.relatedTarget=C||null,s.hide(),o.preventDefault())}},V=o=>{const{element:t,modalDialog:s}=o,a=(e.getElementTransitionDuration(s)||0)+17;e.removeClass(t,M),e.Timer.set(t,()=>e.Timer.clear(t),a)};class O extends e.BaseComponent{static selector=B;static init=_;static getInstance=h;constructor(t,s){super(t,s);const{element:a}=this,n=e.querySelector(`.${r.modalString}-dialog`,a);n&&(this.modalDialog=n,this.triggers=[...e.querySelectorAll(k,e.getDocument(a))].filter(d=>D.getTargetElement(d)===a),this.isStatic=this.options.backdrop==="static",this.hasFade=e.hasClass(a,A.fadeClass),this.relatedTarget=null,this._observer=new ResizeObserver(()=>this.update()),this._toggleEventListeners(!0))}get name(){return l.modalComponent}get defaults(){return L}toggle(){e.hasClass(this.element,c.showClass)?this.hide():this.show()}show(){const{element:t,options:s,hasFade:a,relatedTarget:n}=this,{backdrop:d}=s;let g=0;if(!e.hasClass(t,c.showClass)&&(p.relatedTarget=n||void 0,e.dispatchEvent(t,p),!p.defaultPrevented)){const i=l.getCurrentOpen(t);if(i&&i!==t){const m=h(i)||e.getInstance(i,l.offcanvasComponent);m&&m.hide()}d?(r.hasPopup(l.overlay)?l.toggleOverlayType(!0):l.appendOverlay(t,a,!0),g=e.getElementTransitionDuration(l.overlay),l.showOverlay(),setTimeout(()=>y(this),g)):(y(this),i&&e.hasClass(l.overlay,c.showClass)&&l.hideOverlay())}}hide(){const{element:t,hasFade:s,relatedTarget:a}=this;e.hasClass(t,c.showClass)&&(f.relatedTarget=a||void 0,e.dispatchEvent(t,f),f.defaultPrevented||(e.removeClass(t,c.showClass),e.setAttribute(t,e.ariaHidden,"true"),e.removeAttribute(t,e.ariaModal),s?e.emulateTransitionEnd(t,()=>w(this)):w(this)))}update=()=>{e.hasClass(this.element,c.showClass)&&H(this)};_toggleEventListeners=t=>{const s=t?v.E:v.r,{triggers:a}=this;a.length&&a.forEach(n=>s(n,e.mouseclickEvent,x))};dispose(){const t={...this},{modalDialog:s,hasFade:a}=t,n=()=>setTimeout(()=>super.dispose(),17);this.hide(),this._toggleEventListeners(),a?e.emulateTransitionEnd(s,n):n()}}module.exports=O;
//# sourceMappingURL=modal.cjs.map
