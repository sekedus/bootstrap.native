"use strict";const t=require("./base-component-DaZCwW-u.js"),C=require("./event-listener-BQdA_KAC.js"),h=require("./showClass-D_Ms1FgG.js"),U=require("./dataBsToggle-Dj-Ng54N.js"),b=require("./dropdownClasses-CnEyz_iw.js"),Y="Dropdown",Z="dropdown-menu",z=o=>{const e=t.ke(o,"A");return o.tagName==="A"&&t.ne(o,"href")&&t.j(o,"href").slice(-1)==="#"||e&&t.ne(e,"href")&&t.j(e,"href").slice(-1)==="#"},[p,A,H,I]=b.dropdownMenuClasses,K=`[${U.dataBsToggle}="${p}"]`,f=o=>t.to(o,Y),ot=o=>new V(o),st=`${Z}-end`,_=[p,A],k=[H,I],B=["A","BUTTON"],rt={offset:5,display:"dynamic"},T=t.vo(`show.bs.${p}`),F=t.vo(`shown.bs.${p}`),S=t.vo(`hide.bs.${p}`),W=t.vo(`hidden.bs.${p}`),R=t.vo(`updated.bs.${p}`),J=o=>{const{element:e,menu:n,parentElement:i,options:r}=o,{offset:s}=r;if(t.g(n,"position")!=="static"){const d=t.Uo(e),c=t.Yn(n,st);["margin","top","bottom","left","right"].forEach(a=>{const O={};O[a]="",t.ho(n,O)});let l=b.dropdownMenuClasses.find(a=>t.Yn(i,a))||p;const X={dropdown:[s,0,0],dropup:[0,0,s],dropstart:d?[-1,0,0,s]:[-1,s,0],dropend:d?[-1,s,0]:[-1,0,0,s]},g={dropdown:{top:"100%"},dropup:{top:"auto",bottom:"100%"},dropstart:d?{left:"100%",right:"auto"}:{left:"auto",right:"100%"},dropend:d?{left:"auto",right:"100%"}:{left:"100%",right:"auto"},menuStart:d?{right:"0",left:"auto"}:{right:"auto",left:"0"},menuEnd:d?{right:"auto",left:"0"}:{right:"0",left:"auto"}},{offsetWidth:m,offsetHeight:q}=n,{clientWidth:M,clientHeight:P}=t.S(e),{left:w,top:$,width:N,height:tt}=t.w(e),x=w-m-s<0,y=w+m+N+s>=M,et=$+q+s>=P,j=$+q+tt+s>=P,L=$-q-s<0,E=(!d&&c||d&&!c)&&w+N-m<0,v=(d&&c||!d&&!c)&&w+m>=M;if(k.includes(l)&&x&&y&&(l=p),l===H&&(d?y:x)&&(l=I),l===I&&(d?x:y)&&(l=H),l===A&&L&&!j&&(l=p),l===p&&j&&!L&&(l=A),k.includes(l)&&et&&t.N(g[l],{top:"auto",bottom:0}),_.includes(l)&&(E||v)){let a={left:"auto",right:"auto"};!E&&v&&!d&&(a={left:"auto",right:0}),E&&!v&&d&&(a={left:0,right:"auto"}),a&&t.N(g[l],a)}const nt=X[l];if(t.ho(n,{...g[l],margin:`${nt.map(a=>a&&`${a}px`).join(" ")}`}),_.includes(l)&&c&&c){const a=!d&&E||d&&v?"menuStart":"menuEnd";t.ho(n,g[a])}t.q(i,R)}},it=o=>Array.from(o.children).map(e=>{if(e&&B.includes(e.tagName))return e;const{firstElementChild:n}=e;return n&&B.includes(n.tagName)?n:null}).filter(e=>e),G=o=>{const{element:e,options:n,menu:i}=o,r=o.open?C.E:C.r,s=t.d(e);r(s,t.mt,Q),r(s,t.rt,Q),r(s,t.dt,ct),r(s,t.pt,lt),n.display==="dynamic"&&(o.open?o._observer.observe(i):o._observer.disconnect())},D=o=>{const e=[...b.dropdownMenuClasses,"btn-group","input-group"].map(n=>t.Go(`${n} ${h.showClass}`,t.d(o))).find(n=>n.length);if(e&&e.length)return[...e[0].children].find(n=>b.dropdownMenuClasses.some(i=>i===t.j(n,U.dataBsToggle)))},Q=o=>{const{target:e,type:n}=o;if(!t.m(e))return;const i=D(e),r=i&&f(i);if(!r)return;const{parentElement:s,menu:d}=r,c=s&&s.contains(e)&&(e.tagName==="form"||t.ke(e,"form")!==null);[t.mt,t.bt].includes(n)&&z(e)&&o.preventDefault(),!c&&n!==t.rt&&e!==i&&e!==d&&r.hide()},dt=o=>{const{target:e}=o,n=e&&t.ke(e,K),i=n&&f(n);i&&(o.stopPropagation(),i.toggle(),n&&z(n)&&o.preventDefault())},ct=o=>{[t.on,t.sn].includes(o.code)&&o.preventDefault()};function lt(o){const{code:e}=o,n=D(this);if(!n)return;const i=f(n),{activeElement:r}=t.d(n);if(!i||!r)return;const{menu:s,open:d}=i,c=it(s);if(c&&c.length&&[t.on,t.sn].includes(e)){let u=c.indexOf(r);r===n?u=0:e===t.sn?u=u>1?u-1:0:e===t.on&&(u=u<c.length-1?u+1:u),c[u]&&t.io(c[u])}t.gn===e&&d&&(i.toggle(),t.io(n))}function at(o){const e=D(o),n=e&&f(e);n&&n.open&&J(n)}class V extends t.BaseComponent{static selector=K;static init=ot;static getInstance=f;constructor(e,n){super(e,n);const{parentElement:i}=this.element,[r]=t.Go(Z,i);r&&(this.parentElement=i,this.menu=r,this._observer=new IntersectionObserver(([s])=>at(s.target),{threshold:1}),this._toggleEventListeners(!0))}get name(){return Y}get defaults(){return rt}toggle(){this.open?this.hide():this.show()}show(){const{element:e,open:n,menu:i,parentElement:r}=this;if(n)return;const s=D(e),d=s&&f(s);d&&d.hide(),[T,F,R].forEach(c=>{c.relatedTarget=e}),t.q(r,T),!T.defaultPrevented&&(t.qn(i,h.showClass),t.qn(r,h.showClass),t.Qn(e,t.Oe,"true"),J(this),this.open=!n,t.io(e),G(this),t.q(r,F))}hide(){const{element:e,open:n,menu:i,parentElement:r}=this;n&&([S,W].forEach(s=>{s.relatedTarget=e}),t.q(r,S),!S.defaultPrevented&&(t.Zn(i,h.showClass),t.Zn(r,h.showClass),t.Qn(e,t.Oe,"false"),this.open=!n,G(this),t.q(r,W)))}_toggleEventListeners=e=>{(e?C.E:C.r)(this.element,t.mt,dt)};dispose(){this.open&&this.hide(),this._toggleEventListeners(),super.dispose()}}module.exports=V;
//# sourceMappingURL=dropdown.cjs.map
