"use strict";const t=require("./base-component-D3rSrWwH.js"),C=require("./event-listener-W3RGkfJ6.js"),h=require("./showClass-D_Ms1FgG.js"),z=require("./dataBsToggle-Dj-Ng54N.js"),b=require("./dropdownClasses-CnEyz_iw.js"),K="Dropdown",G="dropdown-menu",J=o=>{const e=t.closest(o,"A");return o.tagName==="A"&&t.hasAttribute(o,"href")&&t.getAttribute(o,"href").slice(-1)==="#"||e&&t.hasAttribute(e,"href")&&t.getAttribute(e,"href").slice(-1)==="#"},[p,$,H,I]=b.dropdownMenuClasses,Q=`[${z.dataBsToggle}="${p}"]`,f=o=>t.getInstance(o,K),ot=o=>new Y(o),st=`${G}-end`,_=[p,$],j=[H,I],q=["A","BUTTON"],rt={offset:5,display:"dynamic"},S=t.createCustomEvent(`show.bs.${p}`),F=t.createCustomEvent(`shown.bs.${p}`),T=t.createCustomEvent(`hide.bs.${p}`),U=t.createCustomEvent(`hidden.bs.${p}`),V=t.createCustomEvent(`updated.bs.${p}`),X=o=>{const{element:e,menu:n,parentElement:i,options:r}=o,{offset:s}=r;if(t.getElementStyle(n,"position")!=="static"){const c=t.isRTL(e),d=t.hasClass(n,st);["margin","top","bottom","left","right"].forEach(l=>{const O={};O[l]="",t.setElementStyle(n,O)});let a=b.dropdownMenuClasses.find(l=>t.hasClass(i,l))||p;const Z={dropdown:[s,0,0],dropup:[0,0,s],dropstart:c?[-1,0,0,s]:[-1,s,0],dropend:c?[-1,s,0]:[-1,0,0,s]},g={dropdown:{top:"100%"},dropup:{top:"auto",bottom:"100%"},dropstart:c?{left:"100%",right:"auto"}:{left:"auto",right:"100%"},dropend:c?{left:"auto",right:"100%"}:{left:"100%",right:"auto"},menuStart:c?{right:"0",left:"auto"}:{right:"auto",left:"0"},menuEnd:c?{right:"auto",left:"0"}:{right:"0",left:"auto"}},{offsetWidth:m,offsetHeight:D}=n,{clientWidth:M,clientHeight:B}=t.getDocumentElement(e),{left:E,top:A,width:L,height:tt}=t.getBoundingClientRect(e),k=E-m-s<0,x=E+m+L+s>=M,et=A+D+s>=B,P=A+D+tt+s>=B,N=A-D-s<0,w=(!c&&d||c&&!d)&&E+L-m<0,v=(c&&d||!c&&!d)&&E+m>=M;if(j.includes(a)&&k&&x&&(a=p),a===H&&(c?x:k)&&(a=I),a===I&&(c?k:x)&&(a=H),a===$&&N&&!P&&(a=p),a===p&&P&&!N&&(a=$),j.includes(a)&&et&&t.ObjectAssign(g[a],{top:"auto",bottom:0}),_.includes(a)&&(w||v)){let l={left:"auto",right:"auto"};!w&&v&&!c&&(l={left:"auto",right:0}),w&&!v&&c&&(l={left:0,right:"auto"}),l&&t.ObjectAssign(g[a],l)}const nt=Z[a];if(t.setElementStyle(n,{...g[a],margin:`${nt.map(l=>l&&`${l}px`).join(" ")}`}),_.includes(a)&&d&&d){const l=!c&&w||c&&v?"menuStart":"menuEnd";t.setElementStyle(n,g[l])}t.dispatchEvent(i,V)}},it=o=>[...o.children].map(e=>{if(e&&q.includes(e.tagName))return e;const{firstElementChild:n}=e;return n&&q.includes(n.tagName)?n:null}).filter(e=>e),W=o=>{const{element:e,options:n,menu:i}=o,r=o.open?C.E:C.r,s=t.getDocument(e);r(s,t.mouseclickEvent,R),r(s,t.focusEvent,R),r(s,t.keydownEvent,dt),r(s,t.keyupEvent,at),n.display==="dynamic"&&(o.open?o._observer.observe(i):o._observer.disconnect())},y=o=>{const e=[...b.dropdownMenuClasses,"btn-group","input-group"].map(n=>t.getElementsByClassName(`${n} ${h.showClass}`,t.getDocument(o))).find(n=>n.length);if(e&&e.length)return[...e[0].children].find(n=>b.dropdownMenuClasses.some(i=>i===t.getAttribute(n,z.dataBsToggle)))},R=o=>{const{target:e,type:n}=o;if(e&&t.isHTMLElement(e)){const i=y(e),r=i&&f(i);if(r){const{parentElement:s,menu:c}=r,d=s&&s.contains(e)&&(e.tagName==="form"||t.closest(e,"form")!==null);[t.mouseclickEvent,t.mousedownEvent].includes(n)&&J(e)&&o.preventDefault(),!d&&n!==t.focusEvent&&e!==i&&e!==c&&r.hide()}}},ct=o=>{const{target:e}=o,n=e&&t.closest(e,Q),i=n&&f(n);i&&(o.stopPropagation(),i.toggle(),n&&J(n)&&o.preventDefault())},dt=o=>{[t.keyArrowDown,t.keyArrowUp].includes(o.code)&&o.preventDefault()};function at(o){const{code:e}=o,n=y(this),i=n&&f(n),{activeElement:r}=n&&t.getDocument(n);if(i&&r){const{menu:s,open:c}=i,d=it(s);if(d&&d.length&&[t.keyArrowDown,t.keyArrowUp].includes(e)){let u=d.indexOf(r);r===n?u=0:e===t.keyArrowUp?u=u>1?u-1:0:e===t.keyArrowDown&&(u=u<d.length-1?u+1:u),d[u]&&t.focus(d[u])}t.keyEscape===e&&c&&(i.toggle(),t.focus(n))}}function lt(o){const e=y(o),n=e&&f(e);n&&n.open&&X(n)}class Y extends t.BaseComponent{static selector=Q;static init=ot;static getInstance=f;constructor(e,n){super(e,n);const{parentElement:i}=this.element,[r]=t.getElementsByClassName(G,i);r&&(this.parentElement=i,this.menu=r,this._observer=new IntersectionObserver(([s])=>lt(s.target),{threshold:1}),this._toggleEventListeners(!0))}get name(){return K}get defaults(){return rt}toggle(){this.open?this.hide():this.show()}show(){const{element:e,open:n,menu:i,parentElement:r}=this;if(!n){const s=y(e),c=s&&f(s);c&&c.hide(),[S,F,V].forEach(d=>{d.relatedTarget=e}),t.dispatchEvent(r,S),S.defaultPrevented||(t.addClass(i,h.showClass),t.addClass(r,h.showClass),t.setAttribute(e,t.ariaExpanded,"true"),X(this),this.open=!n,t.focus(e),W(this),t.dispatchEvent(r,F))}}hide(){const{element:e,open:n,menu:i,parentElement:r}=this;n&&([T,U].forEach(s=>{s.relatedTarget=e}),t.dispatchEvent(r,T),T.defaultPrevented||(t.removeClass(i,h.showClass),t.removeClass(r,h.showClass),t.setAttribute(e,t.ariaExpanded,"false"),this.open=!n,W(this),t.dispatchEvent(r,U)))}_toggleEventListeners=e=>{(e?C.E:C.r)(this.element,t.mouseclickEvent,ct)};dispose(){this.open&&this.hide(),this._toggleEventListeners(),super.dispose()}}module.exports=Y;
//# sourceMappingURL=dropdown.cjs.map
