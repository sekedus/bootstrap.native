{"version":3,"file":"init.mjs","sources":["../../src/util/init.ts"],"sourcesContent":["import { Data, ObjectKeys, ObjectValues, getElementsByTagName, matches } from '@thednp/shorty';\n\nimport { addListener } from '@thednp/event-listener';\n\nimport Alert from '../components/alert';\nimport Button from '../components/button';\nimport Carousel from '../components/carousel';\nimport Collapse from '../components/collapse';\nimport Dropdown from '../components/dropdown';\nimport Modal from '../components/modal';\nimport Offcanvas from '../components/offcanvas';\nimport Popover from '../components/popover';\nimport ScrollSpy from '../components/scrollspy';\nimport Tab from '../components/tab';\nimport Toast from '../components/toast';\nimport Tooltip from '../components/tooltip';\n\nconst componentsList = {\n  Alert,\n  Button,\n  Carousel,\n  Collapse,\n  Dropdown,\n  Modal,\n  Offcanvas,\n  Popover,\n  ScrollSpy,\n  Tab,\n  Toast,\n  Tooltip,\n};\n\n/**\n * Initialize all matched `Element`s for one component.\n *\n * @param callback\n * @param collection\n */\nconst initComponentDataAPI = <T>(\n  callback: (el: HTMLElement, ops?: Record<string, unknown>) => T,\n  collection: HTMLCollectionOf<HTMLElement> | HTMLElement[],\n) => {\n  [...collection].forEach(x => callback(x));\n};\n\n/**\n * Remove one component from a target container element or all in the page.\n *\n * @param component the component name\n * @param context parent `Node`\n */\nconst removeComponentDataAPI = <T>(component: string, context: ParentNode) => {\n  const compData = Data.getAllFor(component) as Map<HTMLElement, T>;\n\n  if (compData) {\n    [...compData].forEach(([element, instance]) => {\n      if (context.contains(element)) (instance as T & { dispose: () => void }).dispose();\n    });\n  }\n};\n\n/**\n * Initialize all BSN components for a target container.\n *\n * @param context parent `Node`\n */\nexport const initCallback = (context?: ParentNode) => {\n  const lookUp = context && context.nodeName ? context : document;\n  const elemCollection = [...getElementsByTagName('*', lookUp)];\n\n  ObjectValues(componentsList).forEach(cs => {\n    const { init, selector } = cs;\n    initComponentDataAPI(\n      init,\n      elemCollection.filter(item => matches(item, selector)),\n    );\n  });\n};\n\n/**\n * Remove all BSN components for a target container.\n *\n * @param context parent `Node`\n */\nexport const removeDataAPI = (context?: ParentNode) => {\n  const lookUp = context && context.nodeName ? context : document;\n\n  ObjectKeys(componentsList).forEach(comp => {\n    removeComponentDataAPI(comp, lookUp);\n  });\n};\n\n// bulk initialize all components\nif (document.body) initCallback();\nelse {\n  addListener(document, 'DOMContentLoaded', () => initCallback(), { once: true });\n}\n"],"names":["componentsList","Alert","Button","Carousel","Collapse","Dropdown","Modal","Offcanvas","Popover","ScrollSpy","Tab","Toast","Tooltip","initComponentDataAPI","callback","collection","x","removeComponentDataAPI","component","context","compData","Data","element","instance","initCallback","lookUp","elemCollection","getElementsByTagName","ObjectValues","cs","init","selector","item","matches","removeDataAPI","ObjectKeys","comp","addListener"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiBA,MAAMA,IAAiB;AAAA,EACrB,OAAAC;AAAA,EACA,QAAAC;AAAA,EACA,UAAAC;AAAA,EACA,UAAAC;AAAA,EACA,UAAAC;AAAA,EACA,OAAAC;AAAA,EACA,WAAAC;AAAA,EACA,SAAAC;AAAA,EACA,WAAAC;AAAA,EACA,KAAAC;AAAA,EACA,OAAAC;AAAA,EACA,SAAAC;AACF,GAQMC,IAAuB,CAC3BC,GACAC,MACG;AACH,GAAC,GAAGA,CAAU,EAAE,QAAQ,CAAKC,MAAAF,EAASE,CAAC,CAAC;AAC1C,GAQMC,IAAyB,CAAIC,GAAmBC,MAAwB;AACtE,QAAAC,IAAWC,EAAK,UAAUH,CAAS;AAEzC,EAAIE,KACD,CAAA,GAAGA,CAAQ,EAAE,QAAQ,CAAC,CAACE,GAASC,CAAQ,MAAM;AACzC,IAAAJ,EAAQ,SAASG,CAAO,KAAIC,EAAyC,QAAQ;AAAA,EAAA,CAClF;AAEL,GAOaC,IAAe,CAACL,MAAyB;AACpD,QAAMM,IAASN,KAAWA,EAAQ,WAAWA,IAAU,UACjDO,IAAiB,CAAC,GAAGC,EAAqB,KAAKF,CAAM,CAAC;AAE/CG,EAAAA,EAAA5B,CAAc,EAAE,QAAQ,CAAM6B,MAAA;AACnC,UAAA,EAAE,MAAAC,GAAM,UAAAC,EAAa,IAAAF;AAC3B,IAAAhB;AAAA,MACEiB;AAAA,MACAJ,EAAe,OAAO,CAAAM,MAAQC,EAAQD,GAAMD,CAAQ,CAAC;AAAA,IAAA;AAAA,EACvD,CACD;AACH,GAOaG,KAAgB,CAACf,MAAyB;AACrD,QAAMM,IAASN,KAAWA,EAAQ,WAAWA,IAAU;AAE5CgB,EAAAA,EAAAnC,CAAc,EAAE,QAAQ,CAAQoC,MAAA;AACzC,IAAAnB,EAAuBmB,GAAMX,CAAM;AAAA,EAAA,CACpC;AACH;AAGI,SAAS,OAAmBD,MAElBa,EAAA,UAAU,oBAAoB,MAAMb,KAAgB,EAAE,MAAM,IAAM;"}